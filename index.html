<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AniMatch - 나와 닮은 애니 주인공의 연인 찾기</title>
    <meta name="description" content="AI가 당신과 닮은 애니메이션 주인공을 찾고, 운명의 히로인을 매칭해드립니다.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.21.0/dist/ort.min.js"></script>
</head>

<body>
    <!-- ==================== MODEL LOADING OVERLAY ==================== -->
    <div id="modelLoadingOverlay" class="model-loading-overlay">
        <div class="model-loading-content">
            <div class="model-loading-icon">🧠</div>
            <p class="model-loading-title">AI 모델 준비 중</p>
            <div class="model-loading-bar">
                <div class="model-loading-progress" id="modelProgress"></div>
            </div>
            <p class="model-loading-status" id="modelStatus">초기화 중...</p>
        </div>
    </div>

    <!-- ==================== SCREEN 1: Landing ==================== -->
    <section id="screen-landing" class="screen active">
        <div class="landing-bg">
            <div class="particle-field" id="particles"></div>
            <div class="glow-orb orb-1"></div>
            <div class="glow-orb orb-2"></div>
            <div class="glow-orb orb-3"></div>
        </div>

        <header class="landing-header">
            <div class="logo">
                <span class="logo-icon">🎌</span>
                <span class="logo-text">AniMatch</span>
            </div>
            <div class="lang-toggle">
                <button class="lang-btn active">한</button>
                <button class="lang-btn">EN</button>
            </div>
        </header>

        <main class="landing-content">
            <div class="hero-badge">✨ 애니메이션 연인 매칭</div>
            <h1 class="hero-title">
                당신의<br>
                <span class="gradient-text">애니메이션 애인</span>을<br>
                찾아보세요
            </h1>
            <p class="hero-subtitle">
                당신의 얼굴을 분석해<br>
                운명의 애니메이션 연인을 매칭해드립니다
            </p>

            <!-- Example cards slider -->
            <div class="example-cards">
                <div class="example-card">
                    <div class="example-img" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                        <span>💙</span>
                    </div>
                    <div class="example-info">
                        <span class="example-name">아스나</span>
                        <span class="example-anime">SAO</span>
                    </div>
                </div>
                <div class="example-card featured">
                    <div class="example-img" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                        <span>💗</span>
                    </div>
                    <div class="example-info">
                        <span class="example-name">렘</span>
                        <span class="example-anime">Re:Zero</span>
                    </div>
                </div>
                <div class="example-card">
                    <div class="example-img" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                        <span>💜</span>
                    </div>
                    <div class="example-info">
                        <span class="example-name">치카</span>
                        <span class="example-anime">카구야님</span>
                    </div>
                </div>
            </div>

            <!-- CTA Button -->
            <button class="cta-btn" onclick="goToScreen('screen-upload')">
                <span>시작하기</span>
                <span class="cta-arrow">→</span>
            </button>

            <!-- AdSense placeholder -->
            <div class="ad-banner">
                <span class="ad-label">AD</span>
                <span>AdSense Banner (728×90)</span>
            </div>
        </main>

        <footer class="landing-footer">
            <p>© 2026 AniMatch · <a href="#" class="footer-link"
                    onclick="event.preventDefault(); showToast('📄 개인정보처리방침 페이지 준비 중')">개인정보처리방침</a> · <a href="#"
                    class="footer-link" onclick="event.preventDefault(); showToast('📄 면책조항 페이지 준비 중')">면책조항</a> · <a
                    href="#" class="footer-link"
                    onclick="event.preventDefault(); showToast('📄 이용약관 페이지 준비 중')">이용약관</a></p>
        </footer>
    </section>

    <!-- ==================== SCREEN 2: Upload ==================== -->
    <section id="screen-upload" class="screen">
        <header class="page-header">
            <button class="back-btn" onclick="goToScreen('screen-landing')">← 돌아가기</button>
            <div class="logo-small">🎌 AniMatch</div>
        </header>

        <main class="upload-content">
            <!-- Orientation Toggle -->
            <div class="orientation-toggle-wrap">
                <div class="orientation-toggle" id="orientationToggle">
                    <button class="toggle-option active" data-value="male" onclick="toggleOrientation('male')">
                        💙 남성향
                    </button>
                    <button class="toggle-option" data-value="female" onclick="toggleOrientation('female')">
                        💗 여성향
                    </button>
                    <div class="toggle-slider" id="toggleSlider"></div>
                </div>
            </div>

            <h2 class="upload-title">사진을 업로드하세요</h2>
            <p class="upload-subtitle">당신의 운명의 애니 연인을 찾아드려요</p>

            <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                <input type="file" id="fileInput" accept="image/*" hidden onchange="handleFileUpload(event)">
                <div class="upload-icon" id="uploadIcon">📸</div>
                <div class="upload-placeholder" id="uploadPlaceholder">
                    <p class="upload-drag-text">클릭 또는 드래그 앤 드롭</p>
                    <p class="upload-format">JPG, PNG, WebP · 최대 10MB</p>
                </div>
                <img id="uploadPreview" class="upload-preview" alt="미리보기">
                <div class="face-guide" id="faceGuide">
                    <div class="face-oval"></div>
                    <p class="face-guide-text">얼굴이 가이드 안에 오도록 해주세요</p>
                </div>
            </div>

            <div class="upload-tips-inline">
                <span class="tip-inline">💡 정면 사진</span>
                <span class="tip-divider">·</span>
                <span class="tip-inline">☀️ 밝은 조명</span>
                <span class="tip-divider">·</span>
                <span class="tip-inline">👤 1인 사진</span>
            </div>

            <!-- Guideline Feedback -->
            <div class="guideline-feedback" id="guidelineFeedback" style="display:none;">
                <div class="feedback-items" id="feedbackItems"></div>
                <button class="crop-btn" id="cropBtn" onclick="openCropModal()">✂️ 사진 크롭하기</button>
            </div>

            <button class="analyze-btn" id="analyzeBtn" disabled onclick="startAnalysis()">
                <span class="analyze-btn-text">분석 시작하기</span>
                <span class="analyze-btn-icon">✨</span>
            </button>

            <div class="privacy-notice">
                🔒 업로드된 사진은 분석 후 즉시 삭제됩니다 · <a href="#" class="privacy-link"
                    onclick="event.preventDefault(); showToast('📄 개인정보처리방침 페이지 준비 중')">개인정보처리방침</a>
            </div>

            <!-- Crop Modal -->
            <div class="crop-modal" id="cropModal">
                <div class="crop-modal-content">
                    <div class="crop-modal-header">
                        <h3>사진 크롭</h3>
                        <button class="crop-close" onclick="closeCropModal()">✕</button>
                    </div>
                    <div class="crop-area" id="cropArea">
                        <img id="cropImage" alt="crop">
                        <div class="crop-rectangle" id="cropRect"></div>
                    </div>
                    <div class="crop-actions">
                        <button class="crop-cancel" onclick="closeCropModal()">취소</button>
                        <button class="crop-apply" onclick="applyCrop()">✂️ 적용하기</button>
                    </div>
                </div>
            </div>
        </main>
    </section>

    <!-- ==================== SCREEN 3: Gacha Loading ==================== -->
    <section id="screen-loading" class="screen">
        <div class="loading-bg">
            <div class="loading-particles" id="loadingParticles"></div>
            <div class="loading-glow"></div>
        </div>

        <main class="loading-content">
            <!-- Progress Steps -->
            <div class="loading-steps">
                <div class="step active" id="step1">
                    <div class="step-dot"></div>
                    <span>얼굴 특징 분석</span>
                </div>
                <div class="step-line" id="stepLine1"></div>
                <div class="step" id="step2">
                    <div class="step-dot"></div>
                    <span>DB 탐색</span>
                </div>
                <div class="step-line" id="stepLine2"></div>
                <div class="step" id="step3">
                    <div class="step-dot"></div>
                    <span>매칭 완료</span>
                </div>
            </div>

            <!-- Gacha Animation Area -->
            <div class="gacha-stage">
                <div class="gacha-silhouette" id="gachaSilhouette">
                    <div class="silhouette-glow"></div>
                    <div class="silhouette-shape">?</div>
                </div>

                <!-- Iconic Quote -->
                <div class="quote-container" id="quoteContainer">
                    <div class="quote-mark">❝</div>
                    <p class="quote-text" id="quoteText"></p>
                    <div class="quote-cursor" id="quoteCursor">|</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">얼굴 특징을 분석하고 있어요...</p>
            </div>
        </main>
    </section>

    <!-- ==================== SCREEN 4: Result ==================== -->
    <section id="screen-result" class="screen">
        <div class="result-bg">
            <div class="result-confetti" id="resultConfetti"></div>
        </div>

        <header class="page-header result-header">
            <button class="back-btn" onclick="goToScreen('screen-landing')">← 처음으로</button>
            <div class="logo-small">🎌 AniMatch</div>
        </header>

        <main class="result-content">
            <!-- Heroine Card - Redesigned -->
            <div class="heroine-card-v2" id="heroineCard">
                <div class="card-glow"></div>

                <!-- Large Hero Image -->
                <div class="heroine-hero-img" id="heroineImg"
                    style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                    <span class="heroine-emoji-lg">💖</span>
                    <!-- Compatibility badge overlay -->
                    <div class="compat-badge" id="compatBadge">
                        <svg class="percentage-ring" viewBox="0 0 36 36">
                            <path class="ring-bg"
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                            <path class="ring-fill"
                                d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
                                stroke-dasharray="89, 100" />
                        </svg>
                        <span class="percentage-text">89%</span>
                        <span class="compat-label">매칭도</span>
                    </div>
                </div>

                <!-- Info Panel -->
                <div class="heroine-info-panel">
                    <div class="card-header">
                        <span class="card-badge">💕 당신의 애니메이션 연인</span>
                    </div>

                    <div class="heroine-name-area">
                        <h2 class="heroine-name" id="heroineName">아스나</h2>
                        <p class="heroine-anime" id="heroineAnime">소드 아트 온라인</p>
                        <div class="heroine-tags" id="heroineTags">
                            <span class="tag">검술</span>
                            <span class="tag">리더십</span>
                            <span class="tag">요리</span>
                        </div>
                    </div>

                    <div class="heroine-details">
                        <div class="detail-section">
                            <h3 class="detail-title">💫 성격 & 특징</h3>
                            <ul class="personality-list" id="personalityList">
                                <li>강인하고 따뜻한 성격의 소유자</li>
                                <li>뛰어난 리더십과 판단력</li>
                                <li>요리를 잘하는 가정적인 면</li>
                                <li>사랑하는 사람을 위해 모든 것을 걸 수 있는 용기</li>
                            </ul>
                        </div>

                        <div class="detail-section charm">
                            <h3 class="detail-title">💕 연인으로서의 매력</h3>
                            <p class="charm-text" id="charmText">
                                "든든하면서도 다정한 파트너."
                            </p>
                        </div>

                        <div class="detail-section">
                            <h3 class="detail-title">🎬 출처 작품</h3>
                            <div class="anime-info">
                                <span class="anime-title" id="animeTitle">소드 아트 온라인 (Sword Art Online)</span>
                                <span class="anime-genre" id="animeGenre">액션 · 로맨스 · 판타지</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Share Buttons -->
            <div class="share-section">
                <h3 class="share-title">결과 공유하기</h3>
                <div class="share-buttons">
                    <button class="share-btn twitter" onclick="shareToX()">
                        <span class="share-icon">𝕏</span>
                        <span>X 공유</span>
                    </button>
                    <button class="share-btn bluesky" onclick="shareToBluesky()">
                        <span class="share-icon">🦋</span>
                        <span>Bluesky</span>
                    </button>
                    <button class="share-btn copy" onclick="copyLink()">
                        <span class="share-icon">🔗</span>
                        <span>링크 복사</span>
                    </button>
                    <button class="share-btn download" onclick="downloadResult()">
                        <span class="share-icon">⬇</span>
                        <span>저장</span>
                    </button>
                </div>
            </div>

            <!-- Retry -->
            <button class="retry-btn" onclick="goToScreen('screen-upload')">
                🔄 다시 해보기
            </button>

            <!-- Ad Banner -->
            <div class="ad-banner result-ad">
                <span class="ad-label">AD</span>
                <span>AdSense Banner (300×250)</span>
            </div>
        </main>
    </section>

    <script src="app.js"></script>
</body>

</html>